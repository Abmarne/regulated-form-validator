var L=Object.create;var b=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var O=(e,r)=>{for(var a in r)b(e,a,{get:r[a],enumerable:!0})},$=(e,r,a,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of V(r))!j.call(e,s)&&s!==a&&b(e,s,{get:()=>r[s],enumerable:!(n=B(r,s))||n.enumerable});return e};var M=(e,r,a)=>(a=e!=null?L(Z(e)):{},$(r||!e||!e.__esModule?b(a,"default",{value:e,enumerable:!0}):a,e)),T=e=>$(b({},"__esModule",{value:!0}),e);var J={};O(J,{FormRenderer:()=>y,default:()=>z,parseConfig:()=>x,validateAll:()=>g,validateField:()=>c});module.exports=T(J);var F=M(require("js-yaml"),1);function x(e){if(typeof e=="object"&&e!==null)return e;let r=String(e||"");try{return F.default.load(r)}catch(a){throw new Error("Invalid YAML/JSON config: "+a.message)}}function S(e){return/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(String(e||"").toUpperCase())}function w(e){return/^[A-Z]{4}0[A-Z0-9]{6}$/.test(String(e||"").toUpperCase())}function A(e){return/^\d{12}$/.test(String(e||""))}var q={pan:S,ifsc:w,aadhaar:A};function Y(e,r){if(!e.when)return!0;let{field:a,equals:n,notEmpty:s,notEquals:p,in:d,notIn:v}=e.when,f=r==null?void 0:r[a];return n!==void 0?f===n:p!==void 0?f!==p:s?f!=null&&String(f).trim()!=="":Array.isArray(d)?d.includes(f):Array.isArray(v)?!v.includes(f):!0}function U(rule,value,values){if(!Y(rule,values))return{valid:!0};switch(rule.type){case"required":return value==null||String(value).trim()===""?{valid:!1,message:rule.message||"This field is required"}:{valid:!0};case"regex":{let e=rule.flags||"";return new RegExp(rule.pattern,e).test(String(value??""))?{valid:!0}:{valid:!1,message:rule.message||"Invalid format"}}case"length":{let e=String(value??""),{min:r,max:a,eq:n}=rule;return typeof n=="number"&&e.length!==n?{valid:!1,message:rule.message||`Length must be ${n}`}:typeof r=="number"&&e.length<r?{valid:!1,message:rule.message||`Length must be \u2265 ${r}`}:typeof a=="number"&&e.length>a?{valid:!1,message:rule.message||`Length must be \u2264 ${a}`}:{valid:!0}}case"enum":return(rule.options||[]).includes(value)?{valid:!0}:{valid:!1,message:rule.message||"Invalid value"};case"number":{let e=Number(value);return Number.isNaN(e)?{valid:!1,message:rule.message||"Must be a number"}:rule.min!=null&&e<rule.min?{valid:!1,message:rule.message||`Must be \u2265 ${rule.min}`}:rule.max!=null&&e>rule.max?{valid:!1,message:rule.message||`Must be \u2264 ${rule.max}`}:{valid:!0}}case"date":{let e=new Date(value);if(Number.isNaN(e.getTime()))return{valid:!1,message:rule.message||"Invalid date"};if(rule.before&&e>=new Date(rule.before))return{valid:!1,message:rule.message||`Must be before ${rule.before}`};if(rule.after&&e<=new Date(rule.after))return{valid:!1,message:rule.message||`Must be after ${rule.after}`};if(rule.ageMin!=null){let r=new Date,a=r.getFullYear()-e.getFullYear(),n=r.getMonth()-e.getMonth();if((n<0||n===0&&r.getDate()<e.getDate())&&a--,a<rule.ageMin)return{valid:!1,message:rule.message||`Must be at least ${rule.ageMin}`}}return{valid:!0}}case"crossField":{let e=values==null?void 0:values[rule.field];return String(value??"")===String(e??"")?{valid:!0}:{valid:!1,message:rule.message||"Values must match"}}case"custom":{let fn=eval("("+rule.custom+")");return fn(value,values)?{valid:!0}:{valid:!1,message:rule.message||"Invalid value"}}default:return q[rule.type]?q[rule.type](value)?{valid:!0}:{valid:!1,message:rule.message||"Invalid input"}:{valid:!0}}}function c(e,r,a={}){for(let n of e.validation||[]){let s=U(n,r,a);if(!s.valid)return s}return{valid:!0}}function g(e=[],r={}){let a={};for(let n of e){let s=c(n,r[n.name],r);s.valid||(a[n.name]=s.message)}return{valid:Object.keys(a).length===0,errors:a}}var l=M(require("react"),1);function y({config:e,onSubmit:r,renderField:a}){let n=Array.isArray(e==null?void 0:e.fields)?e.fields:[],[s,p]=(0,l.useState)({}),[d,v]=(0,l.useState)({}),[f,D]=(0,l.useState)({}),N=(t,i)=>{let m=i!=null&&i.target?i.target.value:i,o={...s,[t.name]:m};p(o);let u=c(t,m,o);v({...d,[t.name]:u.valid?null:u.message})},E=t=>D(i=>({...i,[t.name]:!0})),C=t=>{t.preventDefault();let i=g(n,s);v(i.errors),i.valid&&typeof r=="function"&&r(s)},k=(t,i,m,o)=>{let u={name:t.name,value:i??"",onChange:m,onBlur:o,"aria-invalid":!!d[t.name],"aria-describedby":d[t.name]?`${t.name}-error`:void 0};switch(t.type){case"select":return l.default.createElement("select",{...u},l.default.createElement("option",{value:""},"Select..."),(t.options||[]).map(h=>l.default.createElement("option",{key:h,value:h},h)));case"textarea":return l.default.createElement("textarea",{...u,rows:3});case"number":return l.default.createElement("input",{...u,type:"number"});case"date":return l.default.createElement("input",{...u,type:"date"});default:return l.default.createElement("input",{...u,type:t.type||"text"})}},I=()=>{let t=Object.values(d).some(Boolean),m=n.filter(o=>(o.validation||[]).some(u=>u.type==="required"&&!u.when)).some(o=>{let u=s[o.name];return u==null||String(u).trim()===""});return t||m};return l.default.createElement("form",{onSubmit:C,noValidate:!0},n.map(t=>{let i=s[t.name],m=d[t.name],o=k(t,i,u=>N(t,u),()=>E(t));return l.default.createElement("div",{key:t.name,style:{marginBottom:12}},l.default.createElement("label",{htmlFor:t.name,style:{display:"block",fontWeight:600}},t.label),a?a(t,o,m):o,f[t.name]&&m&&l.default.createElement("span",{id:`${t.name}-error`,style:{color:"crimson",fontSize:12}},m))}),l.default.createElement("button",{type:"submit",disabled:I()},"Submit"))}var z={parseConfig:x,validateField:c,validateAll:g,FormRenderer:y};0&&(module.exports={FormRenderer,parseConfig,validateAll,validateField});
